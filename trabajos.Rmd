---
title: "trabajos de estadistica"
author: "eduardo rodrigo ramírez salgado"
date: "23/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## simulacion de los intervalos de confianza

consideramos una poblacion de 10^6 valores de una distribucion normal de parametros mu=1.5 y sigma=1

```{r cars}
set.seed(1012)
mu=1.5; sigma=1; alpha=0.05
poblacion=rnorm(10^6, mu, sigma)

```

## muestras 
primero definiremos una funcion para, que dada una muestra, un valor sigma, y un nivel de significacion alpha, nos genere el intervalo correspondiente para el parametro mu y el nivel de confianza 100(1-alpha), lo llamaremos ICZ 

```{r pressure, echo=FALSE}
ICZ=function(x, sigma, alpha){
  c(mean(x)-qnorm(1-alpha/2)*sigma/sqrt(length(x)),
    mean(x)+qnorm(1-alpha/2)*sigma/sqrt(length(x)))
}
```

usando las funciones replicate de R generamos las muestras y los intervalos de confianza
```{r}
set.seed(2)
M=replicate(100, ICZ(sample(poblacion,50, replace=TRUE),sigma,alpha))

```

generamos una grafica con todos los intrvalos generados y los que estan en rojo, son aquellos en los que los parametros mu=1.5 no esten en ellos.

```{r}
plot(1:10, type = "n", xlim = c(1.2, 1.8), ylim = c(0, 100), xlab = "valores", ylab = "replicaciones")
seg.int=function(i){
  color="blue";
  if((mu<M[1,i])|(mu>M[2,i])){color="red"}
  segments(M[1,i],i,M[2,i],i, col = color,lwd=3)}
invisible(sapply(1:100, FUN = seg.int))
```

## Intervalos de confianza para el parametro mu de una poblacion cualquiera ## con sigma desconocida, y tamaño muestral grande.

```{r}
media=9.5
sd=0.5
n=1000
alpha2=0.05
cuantil=qnorm(1-alpha2/2)

(extremo.izquierdo=round(media-cuantil*sd/sqrt(n),3))
(extremo.derecho=round(media+cuantil*sd/sqrt(n),3))
```
podemos afirmar con un 95% de confianza que la media poblacional de video consumido por semana, esta entre 9.469 y 9.531 por semana.

## intervalos de confianza parael parametro mu de una poblacion cualquiera ## con la sigma desconocida, y tamaño muestral gde.

con una precision de 1 cm  tendremos que la amplitud maxima sera el doble 2cm, 
por tanto el tamaño necesario sera.
```{r}
media_n <- 170
sig_pilot <- 10
alpha3 <- 0.01
amplitud <-2
cuantil2<- qnorm(1-alpha3/2)
(n.minimo <- ceiling((2*cuantil2*sig_pilot/amplitud)^2))
  
```
###metodo exacto clopper pearson,
```{r}
set.seed(1001)
flores_eleg <- sample(1:150,60, replace = TRUE)
muestra_florg <- iris[flores_eleg,]
head(muestra_florg, 10)


```
##contarlas flores
```{r}
(numero.flores.setosa=table(muestra_florg$Species=="setosa")[2])
```
##calculo de llos intervalos de una binomial
```{r}
library(epitools)
binom.exact(numero.flores.setosa, 60, conf.level = 0.95)
```

#aproximaciones de laplace
```{r}
binom.approx(340, 500, conf.level = 0.95)
```

#calculo de los intervalos de confianza, para desviacion de una normal.
```{r}
tempus <- c(12, 13, 13, 14, 14, 14, 15, 15, 16, 17, 17, 18, 18, 19, 19, 25,25, 26, 27, 30, 33, 34, 35, 40, 40, 51, 51, 58, 59, 83)

#calculo de la varianza
var2 <- var(tempus)
n<-30
#calculamos los cuantiles

alpha4 <- 0.05
(cuantil.izquierda <- qchisq(1-alpha4/2, n-1))
(cuantil.derecha <- qchisq(alpha4/2, n-1))

####calculo de los intervalos de confianza

(valor.izquierdo =(n-1)*var2/cuantil.izquierda)
(valor.derecho = (n-1)*var2/cuantil.derecha)

#por ultimo scacamos los valores al cuadrado.
c(sqrt(valor.izquierdo), sqrt(valor.derecho))

```
#metodo de botstrap 
```{r}
set.seed(42)
X <- replicate(1000, var(sample(iris[flores_eleg,]$Petal.Length, replace = TRUE)))
##a continuacion hayamos los cuantiles

IC.booth <- c(quantile(X, alpha4/2), quantile(X, 1-alpha4/2))
round(IC.booth)

library(boot)
#para hacer el reshape con una funcion predeterminada en R 


```









